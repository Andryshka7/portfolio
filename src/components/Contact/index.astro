---
// Contact component with contact form
import { Mail, Phone, MapPin, Send } from '@lucide/astro'

const CONTACT_OPTINS = [
    {
        name: 'Email',
        icon: Mail,
        value: 'contact@andryshka.com'
    },
    {
        name: 'Phone',
        icon: Phone,
        value: '+371 28176717'
    },
    {
        name: 'Location',
        icon: MapPin,
        value: 'Riga, Latvia'
    }
]
---

<section id='contact' class='bg-gray-900 py-20'>
    <div class='max-w-8xl mx-auto px-4 sm:px-6 lg:px-8'>
        <h2 class='relative mb-16 text-center text-3xl font-bold text-white'>
            <span class='relative z-10'>Get In Touch</span>
            <div
                class='absolute -inset-1 rounded-full bg-gradient-to-r from-cyan-500 to-blue-500 opacity-20 blur'
            >
            </div>
        </h2>

        <div class='grid gap-8 md:grid-cols-2'>
            <!-- Contact Form Card -->
            <div
                class='group rounded-xl border border-cyan-500/30 bg-gradient-to-r from-cyan-900/20 to-gray-800/40 p-6 shadow-lg transition-all duration-300 hover:border-cyan-400/50 hover:shadow-cyan-500/10'
            >
                <div class='mb-6 text-center'>
                    <Send
                        class='mx-auto mb-4 h-12 w-12 text-cyan-400 transition-transform duration-300 group-hover:scale-110'
                    />
                    <h3
                        class='text-xl font-bold text-white transition-colors duration-300 group-hover:text-cyan-400'
                    >
                        Send Message
                    </h3>
                </div>

                <form id='contact-form' class='space-y-4' action='/api/contact' method='POST'>
                    <div class='grid gap-4 sm:grid-cols-2'>
                        <div>
                            <label for='name' class='mb-2 block text-sm font-medium text-gray-300'
                                >Name</label
                            >
                            <input
                                type='text'
                                id='name'
                                name='name'
                                required
                                class='w-full rounded-lg border border-gray-600 bg-gray-700 px-4 py-3 text-white placeholder-gray-400 transition-colors focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none'
                                placeholder='Your name'
                            />
                        </div>
                        <div>
                            <label for='email' class='mb-2 block text-sm font-medium text-gray-300'
                                >Email</label
                            >
                            <input
                                type='email'
                                id='email'
                                name='email'
                                required
                                class='w-full rounded-lg border border-gray-600 bg-gray-700 px-4 py-3 text-white placeholder-gray-400 transition-colors focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none'
                                placeholder='your@email.com'
                            />
                        </div>
                    </div>

                    <div>
                        <label for='subject' class='mb-2 block text-sm font-medium text-gray-300'
                            >Subject</label
                        >
                        <input
                            type='text'
                            id='subject'
                            name='subject'
                            required
                            class='w-full rounded-lg border border-gray-600 bg-gray-700 px-4 py-3 text-white placeholder-gray-400 transition-colors focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none'
                            placeholder='What is this about?'
                        />
                    </div>

                    <div>
                        <label for='message' class='mb-2 block text-sm font-medium text-gray-300'
                            >Message</label
                        >
                        <textarea
                            id='message'
                            name='message'
                            rows='4'
                            required
                            class='w-full resize-none rounded-lg border border-gray-600 bg-gray-700 px-4 py-3 text-white placeholder-gray-400 transition-colors focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 focus:outline-none'
                            placeholder='Tell me about your project...'></textarea>
                    </div>

                    <button
                        type='submit'
                        id='submit-btn'
                        class='relative w-full overflow-hidden rounded-lg bg-gradient-to-r from-cyan-500 to-blue-500 px-6 py-3 font-semibold text-white transition-all duration-300 hover:shadow-lg focus:ring-2 focus:ring-cyan-500/20 focus:outline-none disabled:pointer-events-none'
                    >
                        <div
                            class='absolute inset-0 bg-gradient-to-r from-cyan-600 to-blue-600 opacity-0 transition-opacity duration-300 hover:opacity-100'
                        >
                        </div>
                        <!-- Success overlay -->
                        <div
                            id='success-overlay'
                            class='pointer-events-none absolute inset-0 bg-gradient-to-r from-green-500 to-green-600 opacity-0 duration-300'
                        >
                        </div>
                        <div
                            id='error-overlay'
                            class='pointer-events-none absolute inset-0 bg-gradient-to-r from-red-500 to-red-600 opacity-0 duration-300'
                        >
                        </div>
                        <span class='pointer-events-none relative z-10' id='btn-text'
                            >Send Message</span
                        >
                    </button>
                </form>
            </div>

            <!-- Contact Info Card -->
            <div
                class='group rounded-xl border border-blue-500/30 bg-gradient-to-r from-blue-900/20 to-gray-800/40 p-6 shadow-lg transition-all duration-300 hover:border-blue-400/50 hover:shadow-blue-500/10'
            >
                <div class='mb-6 text-center'>
                    <Mail
                        class='mx-auto mb-4 h-12 w-12 text-blue-400 transition-transform duration-300 group-hover:scale-110'
                    />
                    <h3
                        class='text-xl font-bold text-white transition-colors duration-300 group-hover:text-blue-400'
                    >
                        Get In Touch
                    </h3>
                </div>

                <div class='space-y-4'>
                    {
                        CONTACT_OPTINS.map((option) => (
                            <div class='flex items-center gap-3 rounded-lg border border-gray-600 bg-gray-700/50 px-4 py-3'>
                                <option.icon class='h-5 w-5 text-cyan-400' />
                                <div>
                                    <p class='font-medium text-white'>{option.name}</p>
                                    <a
                                        href={option.value}
                                        class='text-gray-300 transition-colors hover:text-cyan-400'
                                    >
                                        {option.value}
                                    </a>
                                </div>
                            </div>
                        ))
                    }
                </div>

                <div
                    class='mt-6 rounded-lg border border-cyan-500/30 bg-gradient-to-r from-cyan-900/20 to-gray-800/40 p-4'
                >
                    <h4 class='mb-2 font-semibold text-white'>Feel free to contact me</h4>
                    <p class='text-sm text-gray-300'>
                        I'm always open to new connections, innovative ideas, startup
                        collaborations, and creative partnerships. Let's build something amazing
                        together!
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('contact-form') as HTMLFormElement
        const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement
        const btnText = document.getElementById('btn-text') as HTMLSpanElement
        const successOverlay = document.getElementById('success-overlay') as HTMLDivElement
        const errorOverlay = document.getElementById('error-overlay') as HTMLDivElement

        const resetButton = () => {
            submitBtn.disabled = false
            submitBtn.classList.remove('opacity-60')
            btnText.textContent = 'Send Message'

            successOverlay.style.opacity = '0'
            errorOverlay.style.opacity = '0'
        }

        const showSuccess = () => {
            submitBtn.disabled = true
            submitBtn.classList.remove('opacity-60')

            btnText.textContent = 'Message Sent!'

            errorOverlay.style.opacity = '0'
            successOverlay.style.opacity = '1'

            form.reset()
            setTimeout(resetButton, 3000)
        }

        const showError = () => {
            submitBtn.disabled = true
            submitBtn.classList.remove('opacity-60')

            btnText.textContent = 'Error sending message'

            successOverlay.style.opacity = '0'
            errorOverlay.style.opacity = '1'

            setTimeout(resetButton, 3000)
        }

        form?.addEventListener('submit', async function (e) {
            e.preventDefault()

            submitBtn.disabled = true
            submitBtn.classList.add('opacity-60')
            btnText.textContent = 'Sending...'

            try {
                const formData = new FormData(form)

                const response = await fetch('/api/contact', {
                    method: 'POST',
                    body: formData
                })

                const result = await response.json()
                result.success ? showSuccess() : showError()
            } catch (error) {
                console.error('Form submission error:', error)
                showError()
            }
        })
    })
</script>
